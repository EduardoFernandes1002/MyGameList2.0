<div class="container mt-4">
  <h1 class="text-center text-dark mb-5">Administração</h1>

  <div class="AlternarOp">
    <div class="Legal">
      <select name="" class="Selecionar">
        <div class="Option">
          <option value="">Gerenciar Jogos</option>
          <option value="">Gerenciar Usuários</option>
        </div>
      </select>
    </div>

    <div class="ButoesAd gap-4">
      <button class="btn btn-primary" (click)="abrirModal()">
        Adicionar Jogo
      </button>

      <button
        class="DeletarJogo"
        data-bs-toggle="modal"
        data-bs-target="#modalDeletar"
      >
        Deletar Jogo
      </button>
    </div>
  </div>

  <table class="table mt-4 table-striped table-bordered">
    <thead>
      <tr>
        <th class="col-md-1">Nome</th>
        <th class="col-md-2">Sinopse</th>
        <th class="col-md-1">Data</th>
        <th class="col-md-2">Modos</th>
        <th class="col-md-2">Generos</th>
        <th class="col-md-1">Plataformas</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let jogo of jogos">
        <td>{{ jogo.nomeJogo }}</td>
        <td>{{ jogo.sinopseJogo }}</td>
        <td>{{ jogo.dataLancamentoJogo | date }}</td>
        <td>
          <p>
            <span *ngFor="let modo of jogo.modos; let last = last">
              {{ modo.nomeModo }}<span *ngIf="!last">, </span></span
            >
          </p>
        </td>
        <td>
          <p class="card-text">
            <span *ngFor="let genero of jogo.generos; let last = last">
              {{ genero.nomeGenero || genero }}<span *ngIf="!last">, </span>
            </span>
          </p>
        </td>
        <td>
          <p class="card-text">
            <span *ngFor="let plataforma of jogo.plataformas; let last = last">
              {{ plataforma.nomePlataforma || plataforma
              }}<span *ngIf="!last">, </span>
            </span>
          </p>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Modal -->
  <div
    class="modal fade"
    [class.show]="mostrarModal"
    [style.display]="mostrarModal ? 'block' : 'none'"
    tabindex="-1"
    role="dialog"
    aria-labelledby="modalAdicionarLabel"
    aria-modal="true"
    [attr.aria-hidden]="!mostrarModal"
  >
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalAdicionarLabel">Adicionar Jogo</h5>
          <button
            type="button"
            class="btn-close"
            (click)="fecharModal()"
            aria-label="Fechar"
          ></button>
        </div>

        <div class="modal-body">
          <form [formGroup]="form" (ngSubmit)="adicionarJogo()">
            <!-- Campos básicos -->
            <div class="mb-2">
              <label>Nome do Jogo</label>
              <input class="form-control" formControlName="nomeJogo" />
            </div>

            <div class="mb-2">
              <label>Sinopse</label>
              <input class="form-control" formControlName="sinopseJogo" />
            </div>

            <div class="mb-2">
              <label>Imagem (URL)</label>
              <input class="form-control" formControlName="imagemJogo" />
            </div>

            <div class="mb-2">
              <label>Data de Lançamento</label>
              <input
                type="date"
                class="form-control"
                formControlName="dataLancamentoJogo"
              />
            </div>

            <div class="mb-2">
              <label>Distribuidora</label>
              <input class="form-control" formControlName="nomeDistribuidora" />
            </div>

            <div class="mb-2">
              <label>Desenvolvedora</label>
              <input
                class="form-control"
                formControlName="nomeDesenvolvedora"
              />
            </div>

            <!-- Chips Gêneros -->
            <div class="mb-2">
              <label>Gêneros</label>
              <div class="d-flex flex-wrap gap-2 mb-1">
                <span
                  *ngFor="let genero of generos"
                  class="badge bg-primary d-flex align-items-center"
                >
                  {{ genero }}
                  <button
                    type="button"
                    class="btn-close btn-close-white ms-2"
                    aria-label="Remover"
                    (click)="removeGenero(genero)"
                  ></button>
                </span>
              </div>
              <input
                type="text"
                class="form-control"
                placeholder="Digite e pressione vírgula."
                (keydown)="addGenero($event)"
                #inputGenero
              />
            </div>

            <!-- Chips Modos -->
            <div class="mb-2">
              <label>Modos</label>
              <div class="d-flex flex-wrap gap-2 mb-1">
                <span
                  *ngFor="let modo of modos"
                  class="badge bg-success d-flex align-items-center"
                >
                  {{ modo }}
                  <button
                    type="button"
                    class="btn-close btn-close-white ms-2"
                    aria-label="Remover"
                    (click)="removeModo(modo)"
                  ></button>
                </span>
              </div>
              <input
                type="text"
                class="form-control"
                placeholder="Digite e pressione vírgula."
                (keydown)="addModo($event)"
                #inputModo
              />
            </div>

            <!-- Chips Plataformas -->
            <div class="mb-2">
              <label>Plataformas</label>
              <div class="d-flex flex-wrap gap-2 mb-1">
                <span
                  *ngFor="let plataforma of plataformas"
                  class="badge bg-info text-dark d-flex align-items-center"
                >
                  {{ plataforma }}
                  <button
                    type="button"
                    class="btn-close btn-close-white ms-2"
                    aria-label="Remover"
                    (click)="removePlataforma(plataforma)"
                  ></button>
                </span>
              </div>
              <input
                type="text"
                class="form-control"
                placeholder="Digite e pressione vírgula."
                (keydown)="addPlataforma($event)"
                #inputPlataforma
              />
            </div>

            <button type="submit" class="btn btn-primary w-100 mt-3">
              Adicionar Jogo
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
  <div class="modal-backdrop fade show" *ngIf="mostrarModal"></div>
</div>
